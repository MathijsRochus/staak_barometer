ğŸ“Š De Staak Barometer
De Staak Barometer is een interactieve webapplicatie waarmee burgers hun mening kunnen geven over stakingsevenementen. Het doel is om een genuanceerder beeld te krijgen van de publieke opinie, voorbij de "luide meerderheid".

De app is meertalig (NL/FR/EN), ondersteunt veilige authenticatie en toont live resultaten via interactieve grafieken.

âœ¨ Functionaliteiten
Authenticatie: Veilig inloggen, registreren en wachtwoord resetten (via Supabase Auth).

Meertaligheid: Volledige ondersteuning voor Nederlands, Frans en Engels.

Stemmen: Gebruikers kunnen per evenement Ã©Ã©n keer stemmen met opties (Staakt wel/niet & Akkoord/Niet akkoord).

Live Resultaten: Grafieken worden pas zichtbaar na het stemmen en tonen real-time data.

Admin Dashboard: Beveiligde interface om nieuwe stakingsevenementen aan te maken.

Privacy First: Gebruikers zien alleen hun eigen stemgeschiedenis, totalen worden anoniem opgehaald.

ğŸ› ï¸ Technologie Stack
Frontend & Framework: Streamlit (Python)

Database & Auth: Supabase (PostgreSQL)

Data Processing: Pandas

ğŸ“‚ Project Structuur
Het project volgt een MVC-achtige structuur om logica en presentatie te scheiden:

Plaintext

/staak-barometer
â”œâ”€â”€ .streamlit/
â”‚   â””â”€â”€ secrets.toml       # API keys (niet in git!)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ backend/           # Database communicatie & Auth logica
â”‚   â”‚   â”œâ”€â”€ client.py      # Supabase connectie setup
â”‚   â”‚   â””â”€â”€ service.py     # Functies (login, vote, get_events)
â”‚   â”œâ”€â”€ views/             # De pagina's (UI)
â”‚   â”‚   â”œâ”€â”€ login.py       # Login & Registratie tabs
â”‚   â”‚   â”œâ”€â”€ home.py        # Overzicht actieve events
â”‚   â”‚   â”œâ”€â”€ detail.py      # Stemmen & Grafieken
â”‚   â”‚   â””â”€â”€ admin.py       # Event beheer
â”‚   â””â”€â”€ utils/             # Hulptools
â”‚       â””â”€â”€ text.py        # Vertalingen
â”œâ”€â”€ main.py                # Het startpunt (Router)
â”œâ”€â”€ requirements.txt       # Benodigde libraries
â””â”€â”€ README.md              # Dit bestand
ğŸš€ Installatie & Setup
1. Clone de repository
Bash

git clone https://github.com/jouw-gebruikersnaam/staak-barometer.git
cd staak-barometer
2. Virtual Environment aanmaken
Bash

# Windows
python -m venv venv
.\venv\Scripts\activate

# Mac/Linux
python3 -m venv venv
source venv/bin/activate
3. Installeer dependencies
Bash

pip install -r requirements.txt
4. Supabase Configuratie
Maak een bestand .streamlit/secrets.toml aan in de hoofdmap en vul je gegevens in:

Ini, TOML

[supabase]
url = "JOUW_SUPABASE_URL"
key = "JOUW_SUPABASE_ANON_KEY"
5. Database Setup (SQL)
Voer de volgende SQL-scripts uit in je Supabase SQL Editor om de tabellen en beveiliging op te zetten:

<details> <summary>klik hier voor de SQL Setup</summary>

SQL

-- 1. Tabellen
create table public.events (
  id bigint generated by default as identity primary key,
  date date not null,
  sector text not null,
  title jsonb not null,
  description jsonb not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

create table public.votes (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  event_id bigint references public.events not null,
  choice text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  unique (user_id, event_id)
);

-- 2. Row Level Security (RLS)
alter table public.events enable row level security;
alter table public.votes enable row level security;

-- Policies
create policy "Iedereen mag events zien" on public.events for select using (true);
create policy "Admins mogen events maken" on public.events for insert with check (auth.jwt() ->> 'email' = 'JOUW_ADMIN_EMAIL');

create policy "Gebruikers zien eigen stemmen" on public.votes for select using (auth.uid() = user_id);
create policy "Gebruikers mogen stemmen" on public.votes for insert with check (auth.uid() = user_id);

-- 3. Publieke functie voor grafieken (breekt door RLS heen voor tellingen)
create or replace function get_event_stats_public(p_event_id bigint)
returns table (choice text, vote_count bigint)
language sql
security definer
as $$
  select choice, count(*) as vote_count
  from public.votes
  where event_id = p_event_id
  group by choice;
$$;
</details>

â–¶ï¸ Applicatie Starten
Start de applicatie vanuit de root folder:

Bash

streamlit run main.py
ğŸ” Admin Toegang
Standaard hebben gebruikers geen toegang tot het admin-paneel.

Zorg dat je bent ingelogd in de app met je emailadres.

Zorg dat in main.py de variabele ADMIN_EMAIL overeenkomt met jouw emailadres.

De knop "Admin Panel" verschijnt nu in de sidebar op de homepagina.

ğŸ¤ Bijdragen
Pull requests zijn welkom. Voor grote wijzigingen, gelieve eerst een issue te openen om te bespreken wat je wilt veranderen.

ğŸ“„ Licentie
MIT
